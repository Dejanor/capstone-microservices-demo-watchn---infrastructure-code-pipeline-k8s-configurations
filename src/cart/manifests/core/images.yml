#@ load("@ytt:data", "data")

#@ if not len(data.values.image.tag) > 0:
---
apiVersion: kbld.k14s.io/v1alpha1
kind: Sources
sources:
- image: #@ data.values.cart.image.build.id
  path: #@ data.values.cart.image.build.path
  docker:
    build:
      file: #@ data.values.image.build.path + '/java11/Dockerfile'
      rawOptions: ["--build-arg", "JAR_PATH=target/carts-0.0.1-SNAPSHOT.jar"]

#@ if/end data.values.image.push:
---
apiVersion: kbld.k14s.io/v1alpha1
kind: ImageDestinations
destinations:
- image: #@ data.values.cart.image.build.id
  newImage: #@ data.values.image.repository + '/' + data.values.cart.image.name
#@ end

#@ if/end len(data.values.image.tag) > 0:
---
apiVersion: kbld.k14s.io/v1alpha1
kind: ImageOverrides
overrides:
- image: #@ data.values.cart.image.build.id
  newImage: #@ data.values.image.repository + '/' + data.values.cart.image.name + ':' + data.values.image.tag
  preresolved: true
